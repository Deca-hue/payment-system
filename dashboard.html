<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Money App ‚Äî Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* small extras */
    .glass {
      background: rgba(255,255,255,0.6);
      backdrop-filter: blur(6px);
    }
    /* animated username typing effect helper */
    .typewriter {
      overflow: hidden;
      white-space: nowrap;
      border-right: .12em solid rgba(0,0,0,0.2);
      animation: caret 700ms steps(1) infinite;
    }
    @keyframes caret { 50% { border-color: transparent; } 100% { border-color: rgba(0,0,0,0.2); } }
    /* responsive - thin sidebar when collapsed */
    .sidebar-collapsed { width: 72px; }
  </style>
</head>
<body class="bg-gradient-to-b from-slate-50 to-slate-100 min-h-screen">

  <!-- Top navbar -->
  <header class="flex items-center justify-between px-4 py-3 shadow-sm bg-white/60 sticky top-0 z-40">
    <div class="flex items-center gap-4">
      <button id="mobileToggle" class="md:hidden p-2 rounded hover:bg-slate-100" aria-label="toggle">
        ‚ò∞
      </button>
      <div class="flex items-center gap-2">
        <div class="w-10 h-10 bg-indigo-600 text-white rounded flex items-center justify-center font-bold">MA</div>
        <div>
          <div class="text-sm font-semibold">Money App</div>
          <div class="text-xs text-slate-500">Demo dashboard</div>
        </div>
      </div>
    </div>

    <div class="flex items-center gap-3">
      <div class="hidden md:flex items-center gap-2 text-sm text-slate-600">
        <div id="notifBell" class="relative cursor-pointer p-2 rounded hover:bg-slate-100">
          üîî
          <span id="notifDot" class="absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full"></span>
        </div>
        <button onclick="openProfile()" class="flex items-center gap-2 p-1 rounded hover:bg-slate-100">
          <div class="w-8 h-8 rounded-full bg-indigo-200 flex items-center justify-center text-indigo-700 font-semibold" id="avatarInitial">J</div>
          <div class="text-sm" id="navUserName">User</div>
        </button>
      </div>
      <button onclick="logout()" class="bg-red-500 text-white px-3 py-1 rounded text-sm">Logout</button>
    </div>
  </header>

  <div class="flex h-[calc(100vh-64px)]">
    <!-- SIDEBAR -->
    <aside id="sidebar" class="hidden md:flex flex-col gap-4 p-4 w-72 bg-white/60 glass border-r">
      <!-- animated welcome -->
      <div class="mb-2">
        <div class="text-sm text-slate-500">Welcome back</div>
        <div class="text-xl font-bold typewriter" id="animatedName">‚Äî</div>
        <div class="text-xs text-slate-400 mt-1" id="lastSeen">Last seen: just now</div>
      </div>

      <!-- Accounts list -->
      <div>
        <div class="flex items-center justify-between mb-2">
          <div class="text-sm font-semibold">Your Accounts</div>
          <button class="text-xs text-indigo-600" onclick="showAddAccount()">+ Add</button>
        </div>
        <div id="accountsList" class="space-y-2 max-h-56 overflow-auto pr-1"></div>
      </div>

      <div class="mt-auto">
        <button class="w-full text-left px-3 py-2 rounded hover:bg-slate-100" onclick="openSettings()">
          ‚öôÔ∏è Settings
        </button>
        <button class="w-full text-left px-3 py-2 rounded hover:bg-slate-100 text-red-600" onclick="logout()">
          ‚èª Logout
        </button>
      </div>
    </aside>

    <!-- MAIN -->
    <main class="flex-1 p-4 overflow-auto">
      <div class="max-w-4xl mx-auto space-y-6">

        <!-- ACCOUNT SUMMARY -->
        <section class="grid md:grid-cols-3 gap-4 items-start">
          <div class="md:col-span-2 bg-white p-5 rounded-lg shadow flex flex-col gap-3">
            <div class="flex items-center justify-between">
              <div>
                <div class="text-xs text-slate-500">Active Account</div>
                <div class="text-lg font-semibold" id="activeAccountName">Main</div>
                <div class="text-xs text-slate-400">You can rename or add more accounts</div>
              </div>

              <div class="text-right">
                <div class="text-xs text-slate-500">Balance</div>
                <div id="activeBalance" class="text-3xl font-bold">KES 0</div>
                <div class="text-xs text-slate-400" id="balanceUpdated">Updated: now</div>
              </div>
            </div>

            <div class="flex gap-3 mt-3">
              <button onclick="requirePinAndOpen('send')" class="flex-1 bg-blue-600 text-white py-2 rounded shadow">Send</button>
              <button onclick="requirePinAndOpen('withdraw')" class="flex-1 bg-yellow-500 text-white py-2 rounded shadow">Withdraw</button>
              <button onclick="openDeposit()" class="flex-1 bg-green-600 text-white py-2 rounded shadow">Deposit</button>
            </div>

            <!-- quick stats / sparkline -->
            <div class="mt-4 grid grid-cols-3 gap-3 text-sm">
              <div class="p-3 rounded bg-slate-50">
                <div class="text-xs text-slate-500">This Week</div>
                <div class="font-semibold" id="weekNet">+KES 0</div>
              </div>
              <div class="p-3 rounded bg-slate-50">
                <div class="text-xs text-slate-500">Transactions</div>
                <div class="font-semibold" id="txCount">0</div>
              </div>
              <div class="p-3 rounded bg-slate-50">
                <div class="text-xs text-slate-500">Spark</div>
                <div class="mt-2">
                  <svg id="spark" width="120" height="36" viewBox="0 0 120 36" preserveAspectRatio="none"></svg>
                </div>
              </div>
            </div>
          </div>

          <!-- notifications & shortcuts -->
          <div class="bg-white p-4 rounded-lg shadow flex flex-col gap-3">
            <div class="flex items-center justify-between">
              <div class="text-sm font-semibold">Notifications</div>
              <button onclick="clearNotifs()" class="text-xs text-indigo-600">Clear</button>
            </div>
            <div id="notificationsList" class="text-sm text-slate-600">No new notifications</div>

            <hr class="my-2">
            <div class="text-sm font-semibold">Shortcuts</div>
            <div class="grid grid-cols-2 gap-2 mt-2">
              <button class="py-2 rounded border text-sm" onclick="openQrMock()">QR Pay</button>
              <button class="py-2 rounded border text-sm" onclick="openBills()">Pay Bills</button>
              <button class="col-span-2 py-2 rounded border text-sm" onclick="openSupport()">Support</button>
            </div>
          </div>
        </section>

        <!-- TRANSACTIONS -->
        <section class="bg-white p-4 rounded-lg shadow">
          <div class="flex items-center justify-between mb-3">
            <h3 class="font-semibold">Recent Transactions</h3>
            <div class="text-sm text-slate-500">Showing last 20</div>
          </div>
          <div id="txList" class="space-y-2 text-sm">
            <p class="text-slate-500">No transactions yet.</p>
          </div>
          <!-- Delete Transaction Confirmation Modal -->
          <div id="deleteTransactionModal" class="hidden fixed inset-0 z-60 bg-black/50 flex items-center justify-center p-4">
            <div class="bg-white rounded-lg p-6 w-full max-w-sm">
              <h3 class="text-lg font-semibold mb-3">Delete Transaction</h3>
              <p class="text-sm text-slate-500 mb-3">Are you sure you want to delete this transaction? This action cannot be undone.</p>
              <div class="flex gap-2">
                <button class="flex-1 bg-red-600 text-white py-2 rounded" onclick="confirmDeleteTransaction()">Delete</button>
                <button class="flex-1 py-2 rounded border" onclick="closeDeleteTransactionModal()">Cancel</button>
              </div>
            </div>
          </div>
        </section>

      </div>
    </main>
  </div>

  <!-- ACTION MODAL -->
  <div id="actionModal" class="hidden fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4">
    <div class="bg-white rounded-lg p-6 w-full max-w-md">
      <h3 id="actionTitle" class="text-lg font-semibold mb-3">Action</h3>

      <div id="actionForm">
        <div id="recipientField" class="mb-3">
          <label class="text-xs text-slate-600">Recipient (phone or account)</label>
          <input id="recipientInput" class="w-full border p-2 rounded" placeholder="2547XXXXXXXX or Account name">
        </div>

        <label class="text-xs text-slate-600">Amount (KES)</label>
        <input id="amountInput" type="number" class="w-full border p-2 rounded mb-3" placeholder="Amount">

        <label class="text-xs text-slate-600">Note (optional)</label>
        <input id="noteInput" class="w-full border p-2 rounded mb-3" placeholder="For rent, lunch, ..." />
      </div>

      <div class="flex gap-2">
        <button id="confirmActionBtn" class="flex-1 bg-indigo-600 text-white py-2 rounded" onclick="confirmAction()">Confirm</button>
        <button class="flex-1 py-2 rounded border" onclick="closeActionModal()">Cancel</button>
      </div>
    </div>
  </div>

  <!-- PIN / Re-auth Modal -->
  <div id="pinModal" class="hidden fixed inset-0 z-60 bg-black/50 flex items-center justify-center p-4">
    <div class="bg-white rounded-lg p-6 w-full max-w-sm">
      <h3 class="text-lg font-semibold mb-3">Enter PIN to continue</h3>
      <p class="text-sm text-slate-500 mb-3">This action requires re-authentication</p>
      <input id="pinInput" type="password" maxlength="6" class="w-full border p-2 rounded mb-4" placeholder="Your 4-6 digit code">
      <div class="flex gap-2">
        <button class="flex-1 bg-indigo-600 text-white py-2 rounded" onclick="verifyPin()">Unlock</button>
        <button class="flex-1 py-2 rounded border" onclick="closePinModal()">Cancel</button>
      </div>
      <p id="pinMsg" class="text-sm mt-2 text-red-500 hidden"></p>
    </div>
  </div>

  <!-- Add / Rename Account Modal -->
  <div id="acctModal" class="hidden fixed inset-0 z-60 bg-black/50 flex items-center justify-center p-4">
    <div class="bg-white rounded-lg p-6 w-full max-w-sm">
      <h3 id="acctModalTitle" class="text-lg font-semibold mb-3">Add Account</h3>
      <input id="acctNameInput" class="w-full border p-2 rounded mb-3" placeholder="Account name (e.g., Savings)"/>
      <input id="acctInitInput" type="number" class="w-full border p-2 rounded mb-3" placeholder="Starting balance (KES)" />
      <div class="flex gap-2">
        <button class="flex-1 bg-green-600 text-white py-2 rounded" onclick="saveAccount()">Save</button>
        <button class="flex-1 py-2 rounded border" onclick="closeAcctModal()">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Profile drawer (simple) -->
  <div id="profileDrawer" class="hidden fixed right-0 top-0 h-full z-50 bg-black/50 w-full" onclick="closeProfile()">
    <div class="ml-auto bg-white w-80 h-full p-4 shadow-lg" onclick="event.stopPropagation()">
      <div onclick="closeProfile()">
        <h3 class="text-lg font-semibold cursor-pointer" id="profileName">Profile</h3>
        <p class="text-sm text-slate-600 cursor-pointer" id="profilePhone">Phone</p>
      </div>
      <hr class="my-3" />
      <div class="text-sm">
        <button class="w-full text-left py-2 rounded hover:bg-slate-50" onclick="showChangeCode()">Change PIN</button>
        <button class="w-full text-left py-2 rounded hover:bg-slate-50" onclick="openSupport()">Contact Support</button>
        <button class="w-full text-left py-2 rounded hover:bg-slate-50 text-red-600" onclick="logout()">Logout</button>
      </div>
    </div>
  </div>

  <script src="dashboard.js"></script>
</body>
</html>
